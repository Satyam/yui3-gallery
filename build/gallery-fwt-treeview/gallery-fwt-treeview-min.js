YUI.add("gallery-fwt-treeview",function(g,f){var d=g.Lang,c=g.ClassNameManager.getClassName,a=function(h){return c("fw-treeview",h);},e={toggle:a("toggle"),icon:a("icon"),selection:a("selection"),content:a("content"),sel_prefix:a("selected-state")},b="contentBox";g.FWTreeView=g.Base.create("fw-treeview",g.Widget,[g.FlyweightTreeManager],{initializer:function(h){this._domEvents=["click"];this._loadConfig(h.tree);},renderUI:function(){this.get(b).setContent(this._getHTML());},CONTENT_TEMPLATE:"<ul></ul>"},{ATTRS:{defaultType:{value:"FWTreeNode"},toggleOnLabelClick:{value:false,validator:d.isBoolean}}});g.FWTreeNode=g.Base.create("fw-treenode",g.FlyweightTreeNode,[],{initializer:function(){this.after("click",this._afterClick,this);this.after("selectedChange",this._afterSelectedChange,this);},_afterClick:function(h){var i=h.domEvent.target;if(i.hasClass(e.toggle)){this.toggle();}else{if((i.hasClass(e.content)||i.hasClass(e.icon))&&this.get("root").get("toggleOnLabelClick")){this.toggle();}else{if(i.hasClass(e.selection)){this.toggleSelection();}}}},toggleSelection:function(){this.set("selected",(this.get("selected")?0:2));},_afterSelectedChange:function(i){var h=i.newVal;if(!this.isRoot()){g.one("#"+this.get("id")).replaceClass("yui3-fw-treeview-selected-state-"+i.prevVal,"yui3-fw-treeview-selected-state-"+h);if(this.get("propagateUp")&&i.src!=="propagatingDown"){this.getParent()._childSelectedChange().release();}}if(this.get("propagateDown")&&i.src!=="propagatingUp"){this.forEachChild(function(j){j.set("selected",h,"propagatingDown");});}},_childSelectedChange:function(){var i=0,h=0;this.forEachChild(function(j){console.log("nodes",j.get("label"),j.get("selected"));i+=2;h+=j.get("selected");});console.log("counts",this.get("label"),i,h);this.set("selected",(h===0?0:(h===i?2:1)),{src:"propagatingUp"});return this;}},{TEMPLATE:d.sub('<li id="{id}" class="{cname_node} {sel_prefix}-{selected}"><div class="{toggle}"></div><div class="{icon}"></div><div class="{selection}"></div><div class="{content}">{label}</div><ul class="{cname_children}">{children}</ul></li>',e),ATTRS:{selected:{value:0,validator:d.isNumber},propagateUp:{value:true,validator:d.isBoolean},propagateDown:{value:true,validator:d.isBoolean}}});},"@VERSION@",{"requires":["gallery-flyweight-tree","widget","base-build"],"skinnable":true});