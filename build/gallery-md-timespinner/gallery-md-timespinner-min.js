YUI.add("gallery-md-timespinner",function(c){var s="Spinner",d=c.Lang,n="contentBox",b="boundingBox",j="Change",e="value",h="ui",l="TimeSpinner",g="VariableSpeedTimeSpinner",r="ampm",p="min",q="max",a="ActiveTimeSpinner",i="interval",k="seconds",f="speed",o="after",m="wrapped";c[l]=c.Base.create(l,c.Widget,[c.MakeNode],{_hourSp:null,_minSp:null,_secSp:null,_ampmSp:null,f:function(u){if(u){return u.getHours()+":"+u.getMinutes()+":"+u.getSeconds()+"."+u.getMilliseconds();}return u;},renderUI:function(){var t=this.get(n);this._hourSp=new c[s]({min:0,max:this.get(r)?11:23,wraparound:true}).render(t);this._minSp=new c[s]({min:0,max:59,wraparound:true}).render(t);},_uiSetSeconds:function(t){if(t){this._secSp=new c[s]({min:0,max:59,wraparound:true}).render();this._minSp.get(b).insert(this._secSp.get(b),o);this._secSp.after(e+j,this._afterValueChange,this);this._secSp.after(m,this._afterWrapped,this);}else{if(this._secSp){this._secSp.destroy();this._secSp=null;}}},_uiSetAmpm:function(t){if(t){this._ampmSp=new c[s]({min:0,max:1,formatter:function(u){return u.toUpperCase()?"PM":"AM";},parser:function(u){switch(u.toUpperCase()){case"AM":return 0;case"PM":return 1;default:return false;}},wraparound:true}).render();(this._secSp?this._secSp.get(b):this._minSp.get(b)).insert(this._ampmSp.get(b),o);this._ampmSp.after(e+j,this._afterValueChange,this);this._hourSp.set(q,11);}else{this._hourSp.set(q,23);if(this._ampmSp){this._ampmSp.destroy();this._ampmSp=null;}}},bindUI:function(){this._hourSp.after(e+j,this._afterValueChange,this);this._minSp.after(e+j,this._afterValueChange,this);this._minSp.after(m,this._afterWrapped,this);},_afterValueChange:function(){if(this._setting){return;}var t=new Date();t.setHours(this._hourSp.get(e)+(this._ampmSp?12*this._ampmSp.get(e):0));t.setMinutes(this._minSp.get(e));t.setSeconds(this._secSp?this._secSp.get(e):0);this.set(e,t,{src:h});},_afterWrapped:function(u){var t=u.newVal>u.prevVal?-1:1;if(u.target===this._secSp){this._minSp.set(e,this._minSp.get(e)+t);}if(u.target===this._minSp){this._hourSp.set(e,this._hourSp.get(e)+t);}},_uiSetValue:function(u,v){if(v===h){return;}this._setting=true;var t=u.getHours();if(this._ampmSp){this._hourSp.set(e,t>=12?t-12:t);this._ampmSp.set(e,t>=12?1:0);}else{this._hourSp.set(e,t);}this._minSp.set(e,u.getMinutes());if(this._secSp){this._secSp.set(e,u.getSeconds());}this._setting=false;}},{ATTRS:{ampm:{value:false,validator:d.isBoolean},seconds:{value:true,validator:d.isBoolean},value:{valueFn:function(){return new Date();},validator:function(t){return t instanceof Date;}}},_ATTRS_2_UI:{BIND:[r,k,e],SYNC:[r,k,e]}});c[a]=c.Base.create(a,c.TimeSpinner,[],{_timer:null,_offset:0,_updateTime:function(){this._uiSetValue(this._getTime());},_uiSetInterval:function(t){if(this._timer){this._timer.cancel();}this._timer=c.later(t,this,this._updateTime,[],true);},_getTime:function(){return new Date(Date.now()-this._offset);},_setTime:function(t){this._offset=Date.now()-t.getTime();return t;}},{ATTRS:{interval:{value:500,validator:d.isNumber},value:{getter:"_getTime",setter:"_setTime"}},_ATTRS_2_UI:{BIND:i,SYNC:i}});c[g]=c.Base.create(g,c[a],[],{_slider:null,initializer:function(){},renderUI:function(){var t=this.get(n);c[g].superclass.renderUI.apply(this,arguments);t.appendChild(this._makeNode(c[g]._SLIDER_BOX_TEMPLATE));t.appendChild(this._makeNode(c[g]._FACTOR_TEMPLATE));this._locateNodes();this._slider=new c.Slider().render(this._sliderNode);this._sliderNode.appendChild(this._factorNode);},bindUI:function(){this._slider.after(e+j,this._afterSliderChange,this);this.after(f+j,this._afterSpeedChange,this);c[g].superclass.bindUI.apply(this,arguments);},_uiSetSpeed:function(t,u){this._factorNode.setContent(Math.round(t*100)/100);if(u!==h){this._slider.set(e,Math.log(t)/Math.LN10);}},_uiSetMin:function(t){this._slider.set(p,Math.log(t)/Math.LN10);},_uiSetMax:function(t){this._slider.set(q,Math.log(t)/Math.LN10);},_afterSpeedChange:function(u){var t=Date.now();this._offset=t-(t-this._offset)*u.prevVal/u.newVal;},_afterSliderChange:function(t){this.set(f,Math.exp(t.newVal*Math.LN10),{src:h});},_getTime:function(){return new Date((Date.now()-this._offset)*this.get(f));}},{_CLASS_NAMES:["factor","slider"],_SLIDER_BOX_TEMPLATE:'<fieldset class="{c slider}"><legend>Speed Multiplier</legend></fieldset>',_FACTOR_TEMPLATE:'<span class="{c factor}">{@ speed}</span>',ATTRS:{speed:{value:1,validator:d.isNumber},min:{value:0.5,validator:d.isNumber},max:{value:20,validator:d.isNumber}},_ATTRS_2_UI:{BIND:[f,p,q],SYNC:[f,p,q]}});},"@VERSION@",{skinnable:false,requires:["gallery-md-spinner","gallery-makenode"]});